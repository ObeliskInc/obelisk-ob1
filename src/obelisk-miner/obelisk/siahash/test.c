// Test file to verify that the library is correct.

#include <stdbool.h>
#include <stdint.h>
#include <stdio.h>
#include "siaverify.h"

int main(void) {
	printf("Starting verification tests\n");

	// Known Valid:
	uint8_t testOneHeader[80] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x34, 0x6f, 0x8b, 0xb8, 0x8b, 0xf6, 0x7e, 0x19, 0x4a, 0xc2, 0x06, 0x4b, 0xb4, 0x16, 0x5f, 0x90, 0x04, 0x5d, 0x84, 0x46, 0x97, 0xab, 0x37, 0x1a, 0xd0, 0x5f, 0x98, 0x33, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x17, 0x7e, 0x55, 0x00, 0x00, 0x00, 0x00, 0x89, 0x4e, 0x20, 0x2a, 0x44, 0x1b, 0x79, 0xa7, 0x67, 0x6b, 0xb5, 0x7f, 0x61, 0xd7, 0x7f, 0x8c, 0xfb, 0x6c, 0x3d, 0xca, 0x6d, 0xd6, 0x0c, 0xa8, 0xc8, 0x92, 0x4d, 0xbb, 0xcb, 0x74, 0x8c, 0x6b};
	bool testOneResult = siaHeaderMeetsMinimumTarget(testOneHeader);
	if(testOneResult) {
		printf("Test one passed.\n");
	} else {
		printf("TEST ONE HAS FAILED\n");
		printf("TEST ONE HAS FAILED\n");
		printf("TEST ONE HAS FAILED\n");
	}

	// Known Invalid:
	//
	// Made invalid by tweaking 1 character of the valid hash.
	uint8_t testTwoHeader[80] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x34, 0x6f, 0x8b, 0xb8, 0x8b, 0xf6, 0x7e, 0x19, 0x4a, 0xc2, 0x06, 0x4b, 0xb4, 0x16, 0x5f, 0x90, 0x04, 0x5d, 0x84, 0x46, 0x97, 0xab, 0x37, 0x1a, 0xd0, 0x5f, 0x98, 0x33, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x17, 0x7e, 0x55, 0x00, 0x00, 0x00, 0x00, 0x89, 0x4e, 0x20, 0x2a, 0x44, 0x1b, 0x79, 0xa7, 0x67, 0x6c, 0xb5, 0x7f, 0x61, 0xd7, 0x7f, 0x8c, 0xfb, 0x6c, 0x3d, 0xca, 0x6d, 0xd6, 0x0c, 0xa8, 0xc8, 0x92, 0x4d, 0xbb, 0xcb, 0x74, 0x8c, 0x6b};
	bool testTwoResult = siaHeaderMeetsMinimumTarget(testTwoHeader);
	if(!testTwoResult) {
		printf("Test two passed.\n");
	} else {
		printf("TEST TWO HAS FAILED\n");
		printf("TEST TWO HAS FAILED\n");
		printf("TEST TWO HAS FAILED\n");
	}

	// Known valid, meets a 40k difficulty.
	uint8_t testThreeHeader[80] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x34, 0x6f, 0x8b, 0xb8, 0x8b, 0xf6, 0x7e, 0x19, 0x4a, 0xc2, 0x06, 0x4b, 0xb4, 0x16, 0x5f, 0x90, 0x04, 0x5d, 0x84, 0x46, 0x97, 0xab, 0x37, 0x1a, 0xd0, 0x5f, 0x98, 0x33, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x17, 0x7e, 0x55, 0x00, 0x00, 0x00, 0x00, 0x89, 0x4e, 0x20, 0x2a, 0x44, 0x1b, 0x79, 0xa7, 0x67, 0x6b, 0xb5, 0x7f, 0x61, 0xd7, 0x7f, 0x8c, 0xfb, 0x6c, 0x3d, 0xca, 0x6d, 0xd6, 0x0c, 0xa8, 0xc8, 0x92, 0x4d, 0xbb, 0xcb, 0x74, 0x8c, 0x6b};
	bool testThreeResult = siaHeaderMeetsProvidedDifficulty(testThreeHeader, 40000); // 40k difficulty.
	if (testThreeResult) {
		printf("Test three passed.\n");
	} else {
		printf("TEST THREE FAILED\n");
		printf("TEST THREE FAILED\n");
		printf("TEST THREE FAILED\n");
	}

	// Known valid, does not meet a 60k difficulty.
	uint8_t testFourHeader[80] = {0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x34, 0x6f, 0x8b, 0xb8, 0x8b, 0xf6, 0x7e, 0x19, 0x4a, 0xc2, 0x06, 0x4b, 0xb4, 0x16, 0x5f, 0x90, 0x04, 0x5d, 0x84, 0x46, 0x97, 0xab, 0x37, 0x1a, 0xd0, 0x5f, 0x98, 0x33, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x17, 0x7e, 0x55, 0x00, 0x00, 0x00, 0x00, 0x89, 0x4e, 0x20, 0x2a, 0x44, 0x1b, 0x79, 0xa7, 0x67, 0x6b, 0xb5, 0x7f, 0x61, 0xd7, 0x7f, 0x8c, 0xfb, 0x6c, 0x3d, 0xca, 0x6d, 0xd6, 0x0c, 0xa8, 0xc8, 0x92, 0x4d, 0xbb, 0xcb, 0x74, 0x8c, 0x6b};
	bool testFourResult = siaHeaderMeetsProvidedDifficulty(testFourHeader, 60000); // 60k difficulty.
	if (!testFourResult) {
		printf("Test four passed.\n");
	} else {
		printf("TEST FOUR FAILED\n");
		printf("TEST FOUR FAILED\n");
		printf("TEST FOUR FAILED\n");
	}

	// Known invalid, does not meet a 60k difficulty.
	uint8_t testFiveHeader[80] = {0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x34, 0x6f, 0x8b, 0xb8, 0x8b, 0xf6, 0x7e, 0x19, 0x4a, 0xc2, 0x06, 0x4b, 0xb4, 0x16, 0x5f, 0x90, 0x04, 0x5d, 0x84, 0x46, 0x97, 0xab, 0x37, 0x1a, 0xd0, 0x5f, 0x98, 0x33, 0x17, 0x00, 0x00, 0x00, 0x00, 0x00, 0x7c, 0x17, 0x7e, 0x55, 0x00, 0x00, 0x00, 0x00, 0x89, 0x4e, 0x20, 0x2a, 0x44, 0x1b, 0x79, 0xa7, 0x67, 0x6b, 0xb5, 0x7f, 0x61, 0xd7, 0x7f, 0x8c, 0xfb, 0x6c, 0x3d, 0xca, 0x6d, 0xd6, 0x0c, 0xa8, 0xc8, 0x92, 0x4d, 0xbb, 0xcb, 0x74, 0x8c, 0x6b};
	bool testFiveResult = siaHeaderMeetsProvidedDifficulty(testFiveHeader, 60000); // 40k difficulty.
	if (!testFiveResult) {
		printf("Test five passed.\n");
	} else {
		printf("TEST FIVE FAILED\n");
		printf("TEST FIVE FAILED\n");
		printf("TEST FIVE FAILED\n");
	}

	printf("Verfication tests complete\n");
	return 0;
}


/*
 * Additional tests we can try:
000000000001871a184ca869f54e2029759cd380e9ba386386a0032199cd15394d19c4020000000029267e5500000000fb8afce2f1773ff32f370143e8350a8a4761a9082426dcc8c15eddf571183f64
0000000000009d9ea027b6abc4bc84aa040606625dd9ba516ffd4d1e697e738f

000000000002b556b680fcc7038c1fbb9ee6dd580f0f2ad75cb26c6b0ce1bd6d2d64a30000000000ae427e550000000029fb9cb46592eca28320123cab8ae6153cb79ce458fe629470c41a15ffc9d8d6
000000000000a5e2f4255320b36ea1dc142d46b1f620519df47198767df6e8b1

00000000000297b3324ce8385d60717afd1b710e0514195e62208af389e88e7ab569640000000002a0567e5500000000275e87e5ac2ad2ac4269477ed01c2305c1d9ee3e5e7406c509b66ff0155b7015
00000000000184ef4988469632798d9cc0d01d6742dd73e370ad1fa91b11ffb6

000000000000d091f127ef91e57274e9082e9fc901430d382298e1e44d321326148b2d0900000000f8637e55000000002353715d758709dcdf9a8c2bb6faeb86b8364f917495790df5d38c32ab53c2e0
000000000000a472c92ad4c8a4affd1352a71fb5482555971ba80655752dd23e

0000000000008a069e5e74ccbad6b79d272c9ad849b28fc51387c0876a587f486b99ef0a0000000097777e55000000007ffb511cc01ccb08a6b443c02466ff035c186126a97db948813533c8b43bafef
00000000000026c9d7ba285d4bd46cbb50a0c97f0df953d2226938850ba9bdda

00000000000082a9bd7cea6b8477caf52f7ecd2f8b508e9b7a959d59160101a03c45451b00000000e5857e5500000000423fa704895e605ce54dd83f34dac4a7200be954c1f4c9eda148cfc0f74720fb
0000000000014fa2f87ad80984b7f4ee6bb96701a35aaf6a9032858d52dbfe1e

0000000000014df1a65217860e7c00b2a921700e05e58dcae6f16c572d7d866c5d319f0100000000e7a57e5500000000c6f9f6ffd90ed2b4056f1fff23a8b6df39c782ee0d5bd6c7a9c60c830b34d151
00000000000056cf5e7024436ff5cdf2d23780feea94a4d0440ffdf546333cb5

00000000000019a581342602a66b61c406fac8014c6bf891ac4c16c5c6d0e14720a067000000000c7bbb7e5500000000d9b1ebaa72f0979934c52496499eb3ad59f03a8d79c812da6265faea0f945471
000000000000214de681d7720fe059171176f4edf9b55457033d0feca8e6df70

00000000000237bf594510f554d3b4e287d291605aa848eb56a44aa1bc4f530ec09a38110000000052c77e5500000000c890c10d3a7e1094cd68af6c72ed8adb77031eecc1334e3aad270e0c83cd4043
00000000000277acc5743f8822d30df3a78ebca45e8d25e5903ec1b65d1a7c36

0000000000014c434edca417c3bb3d467cc5ff31a84a872640461d1b49fc1459d8eb8301000000001ede7e550000000054f43c71df017ce3b992ff2761cfa154fc64a70b74af0ef9d902c12df9ecfbd6
0000000000000f0af27341e8f32547414cbf5191410889c773974e066200998a

0000000000020d95d9dd9e20d480ca356183d97b98fbc35ea132e7aac5293a3f1710f30300000000d5f67e550000000059190f4de38102203ae728588590499003dedc977184f9a5c157e6f50c6be496
000000000000accf9994b317c7c10eeb1f10e8500b7de8b028c7769abf2175a6

00000000000128afb9cac87a67a1087c212ee52c1b03cb701bbf81bbcc980cee1cd8941200000000790b7f5500000000131bf76acf255ffa3bef2da1291d9f54251bc1ebd0386c93bbc78c29b714fb14
00000000000233176fb3cf4f249daaa30874f3a55c4c9d6194e4677675da272b

0000000000016decd36e6b70dc37dc82baaab4bead8f12990c405f3009c0bf007f9f4b000000000e55337f5500000000b9180b243b65a725ec1fd2f2d0596c7af42517cce43dd0c365c34c9f392cda04
0000000000007d656e3bb0099737892b9073259cb05883b04c6f518fbf0faffb
*/
